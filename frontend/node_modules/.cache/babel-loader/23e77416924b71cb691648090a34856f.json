{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Rokas/Desktop/productionRrloto/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Rokas/Desktop/productionRrloto/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Rokas/Desktop/productionRrloto/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import CircularProgress from'@mui/material/CircularProgress';import Box from'@mui/material/Box';import axios from'../api/axios';import{usePromiseTracker,trackPromise}from\"react-promise-tracker\";import Dropdown from'react-bootstrap/Dropdown';import Table from'react-bootstrap/Table';import ResponseNotification from'../Components/ResponseNotification';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Profile=function Profile(props){var _data$orders;var getToken=localStorage.getItem('userToken');var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),paymentSuccessMessage=_useState4[0],setPaymentSuccessMessage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showNotification=_useState6[0],setShowNotification=_useState6[1];var _usePromiseTracker=usePromiseTracker({area:props.area}),promiseInProgress=_usePromiseTracker.promiseInProgress;var query=window.location.search.substring(1);useEffect(function(){if(getToken){var getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/ticket-list/\".concat(getToken));case 2:_yield$axios$get=_context.sent;res=_yield$axios$get.data;setData(res);case 5:case\"end\":return _context.stop();}}},_callee);}));return function getData(){return _ref.apply(this,arguments);};}();if(query){var getPaymentAnswer=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(\"/accepted/\".concat(query)).then(function(res){if(res.status===200){setPaymentSuccessMessage(res.data);setShowNotification(true);window.history.pushState({},document.title,\"/\"+\"profile\");}});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function getPaymentAnswer(){return _ref2.apply(this,arguments);};}();trackPromise(getPaymentAnswer());}trackPromise(getData());}},[paymentSuccessMessage]);return/*#__PURE__*/_jsxs(_Fragment,{children:[promiseInProgress&&/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',position:'absolute',top:'0',left:'0',right:'0',height:'100%',alignItems:'center'},children:/*#__PURE__*/_jsx(CircularProgress,{})}),!promiseInProgress&&/*#__PURE__*/_jsxs(\"div\",{className:\"container d-flex profile justify-content-between\",children:[/*#__PURE__*/_jsx(ResponseNotification,{data:paymentSuccessMessage,showNotification:showNotification,setShowNotification:setShowNotification}),data&&((_data$orders=data.orders)===null||_data$orders===void 0?void 0:_data$orders.map(function(order){return/*#__PURE__*/_jsxs(\"div\",{className:\"card card-ticket text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsxs(\"div\",{children:[\"Order number: \",order.order_nr]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsxs(Dropdown,{className:\"w-100\",children:[/*#__PURE__*/_jsxs(Dropdown.Toggle,{variant:\"success\",id:\"dropdown-basic\",className:\"w-100 d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Number of tickets: \",order.quantity]}),/*#__PURE__*/_jsxs(\"div\",{children:[order.active===0&&'Waiting for activation',order.active===1&&'Actived',order.active===2&&'Cancelled']})]}),/*#__PURE__*/_jsx(Dropdown.Menu,{children:/*#__PURE__*/_jsx(\"div\",{className:\"tickets d-flex w-100 justify-content-between\",children:/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"th\",{children:\"Ticket number\"})})}),/*#__PURE__*/_jsx(\"tbody\",{children:order.tickets.map(function(ticket){return/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsxs(\"td\",{children:[\"# \",ticket.ticketNumber]})},ticket.id);})})]})})})]})})]});})),data.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"card card-ticket text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"div\",{children:\"Order information\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsx(\"div\",{children:\"You have not purchased a ticket at this time\"})})]})]})]});};export default Profile;","map":{"version":3,"names":["React","useState","useEffect","CircularProgress","Box","axios","usePromiseTracker","trackPromise","Dropdown","Table","ResponseNotification","Profile","props","getToken","localStorage","getItem","data","setData","paymentSuccessMessage","setPaymentSuccessMessage","showNotification","setShowNotification","area","promiseInProgress","query","window","location","search","substring","getData","get","res","getPaymentAnswer","then","status","history","pushState","document","title","display","justifyContent","position","top","left","right","height","alignItems","orders","map","order","order_nr","quantity","active","tickets","ticket","ticketNumber","id","length"],"sources":["C:/Users/Rokas/Desktop/productionRrloto/frontend/src/Pages/Profile.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport CircularProgress from '@mui/material/CircularProgress';\r\nimport Box from '@mui/material/Box';\r\nimport axios from '../api/axios';\r\nimport { usePromiseTracker, trackPromise } from \"react-promise-tracker\";\r\nimport Dropdown from 'react-bootstrap/Dropdown';\r\nimport Table from 'react-bootstrap/Table';\r\nimport ResponseNotification from '../Components/ResponseNotification';\r\n\r\n\r\n\r\nconst Profile = (props) => {\r\n\r\n    const getToken = localStorage.getItem('userToken');\r\n    \r\n    const [data, setData] = useState([]);\r\n    const [paymentSuccessMessage, setPaymentSuccessMessage] = useState('');\r\n    const [showNotification, setShowNotification] = useState(false);\r\n\r\n    const { promiseInProgress } = usePromiseTracker({area: props.area});\r\n\r\n    const query =  window.location.search.substring(1);\r\n\r\n    useEffect(() => {\r\n        if(getToken)\r\n        {\r\n            const getData = async () => {\r\n                \r\n                    const {data: res} = await axios.get(`/ticket-list/${getToken}`)\r\n                    setData(res);\r\n                \r\n            }\r\n            if(query)\r\n            {\r\n                const getPaymentAnswer = async () =>{\r\n                    await axios.get(`/accepted/${query}`)\r\n                    .then((res)=> {\r\n                        if(res.status === 200)\r\n                        {\r\n                            setPaymentSuccessMessage(res.data);\r\n                            setShowNotification(true);\r\n                            window.history.pushState({}, document.title, \"/\" + \"profile\")\r\n                        }\r\n                    })\r\n                }\r\n                trackPromise(getPaymentAnswer());\r\n            }\r\n            trackPromise(getData());\r\n        }\r\n    }, [paymentSuccessMessage])\r\n    \r\n    return(\r\n        <>\r\n            {promiseInProgress &&\r\n                <Box sx={{ \r\n                    display: 'flex', \r\n                    justifyContent: 'center', \r\n                    position: 'absolute', \r\n                    top: '0', \r\n                    left: '0', \r\n                    right: '0', \r\n                    height: '100%', \r\n                    alignItems: 'center'\r\n                }}>\r\n                    <CircularProgress />\r\n                </Box>\r\n            }\r\n            {!promiseInProgress &&\r\n                <div className='container d-flex profile justify-content-between'>\r\n                    <ResponseNotification data={paymentSuccessMessage} showNotification={showNotification} setShowNotification={setShowNotification} />\r\n                    {data && \r\n                        (data.orders?.map((order) => (\r\n                            <div className=\"card card-ticket text-center\">\r\n                                        <div className=\"card-header\">\r\n                                            <div>\r\n                                                Order number: {order.order_nr}\r\n                                            </div>\r\n                                        </div>\r\n                                    <div className='card-body'>\r\n                                    <Dropdown className='w-100'>\r\n                                        <Dropdown.Toggle variant=\"success\" id=\"dropdown-basic\" className='w-100 d-flex justify-content-between align-items-center'>\r\n                                            <div>\r\n                                                Number of tickets: {order.quantity}\r\n                                            </div>\r\n                                            <div>\r\n                                                {order.active === 0 && ('Waiting for activation')}\r\n                                                {order.active === 1 && ('Actived')}\r\n                                                {order.active === 2 && ('Cancelled')}\r\n                                            </div>\r\n                                        </Dropdown.Toggle>\r\n\r\n                                        <Dropdown.Menu>\r\n                                                <div className='tickets d-flex w-100 justify-content-between'>\r\n                                                <Table striped bordered>\r\n                                                    <thead>\r\n                                                        <tr>\r\n                                                            <th>Ticket number</th>\r\n                                                        </tr>\r\n                                                    </thead>\r\n                                                    <tbody>\r\n                                                        {order.tickets.map((ticket) => (\r\n                                                            <tr key={ticket.id}>\r\n                                                                <td># {ticket.ticketNumber}</td>\r\n                                                            </tr>\r\n                                                        ))}\r\n                                                    </tbody>\r\n                                                </Table>\r\n                                            </div>\r\n                                        </Dropdown.Menu>\r\n                                    </Dropdown>\r\n                                </div>\r\n                            </div>\r\n                        )\r\n                    ))}\r\n                    {data.length === 0 && (\r\n                        <div className=\"card card-ticket text-center\">\r\n                            <div className=\"card-header\">\r\n                                <div>\r\n                                    Order information\r\n                                </div>\r\n                            </div>\r\n                            <div className='card-body'>\r\n                                <div>\r\n                                    You have not purchased a ticket at this time\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Profile;"],"mappings":"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"},"metadata":{},"sourceType":"module"}