{"ast":null,"code":"import _objectSpread from\"C:/Users/Rokas/Desktop/productionRrloto/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/Rokas/Desktop/productionRrloto/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Rokas/Desktop/productionRrloto/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Rokas/Desktop/productionRrloto/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import axios from'../api/axios';import Table from'react-bootstrap/Table';import{useNavigate}from'react-router-dom';import CancelModal from'../Components/CancelModal';import ResponseNotification from'../Components/ResponseNotification';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Admin=function Admin(){var _data$orders;var navigate=useNavigate();var sessionToken=sessionStorage.getItem(\"loggedIn\");var _useState=useState({}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),msg=_useState4[0],setMsg=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showCancelModal=_useState6[0],setShowCancelModal=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),orderId=_useState8[0],setOrderId=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),searchQuery=_useState10[0],setSearchQuery=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),responseData=_useState12[0],setResponseData=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),showNotification=_useState14[0],setShowNotification=_useState14[1];useEffect(function(){if(!sessionToken){navigate('/login');}var getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/admin');case 2:_yield$axios$get=_context.sent;res=_yield$axios$get.data;setData(res);case 5:case\"end\":return _context.stop();}}},_callee);}));return function getData(){return _ref.apply(this,arguments);};}();getData();},[msg]);var handleAccept=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(data){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post(\"/admin/confirm/\".concat(data)).then(function(res){var someData=_objectSpread({},[res.data.success]);setMsg(someData);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function handleAccept(_x){return _ref2.apply(this,arguments);};}();var handleCancel=function handleCancel(value){setOrderId(value);setShowCancelModal(true);};var handleClick=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.post(\"/admin/get-winner\").then(function(res){setResponseData(res.data);setShowNotification(true);});case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function handleClick(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:sessionToken&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CancelModal,{showCancelModal:showCancelModal,setShowCancelModal:setShowCancelModal,orderId:orderId,setMsg:setMsg}),/*#__PURE__*/_jsxs(\"div\",{className:\"container d-flex admin-panel justify-content-center\",children:[/*#__PURE__*/_jsx(ResponseNotification,{data:responseData,showNotification:showNotification,setShowNotification:setShowNotification}),/*#__PURE__*/_jsxs(\"div\",{className:\"card card-ticket text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:\"Admin\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"div\",{className:\"form-outline\",children:/*#__PURE__*/_jsx(\"input\",{type:\"search\",className:\"form-control\",placeholder:\"search\",onChange:function onChange(e){return setSearchQuery(e.target.value);}})})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:handleClick,children:\"I\\u0161rinkti nugal\\u0117toj\\u0105\"})}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name,Lastname\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:(_data$orders=data.orders)===null||_data$orders===void 0?void 0:_data$orders.filter(function(order){return order.order_nr.includes(searchQuery)||order.tickets[0].name.includes(searchQuery)||order.tickets[0].lastname.includes(searchQuery);}).map(function(order){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order.order_nr}),/*#__PURE__*/_jsxs(\"td\",{children:[order.tickets[0].name,\" \",order.tickets[0].lastname]}),/*#__PURE__*/_jsxs(\"td\",{children:[order.active===0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger admin-table\",onClick:function onClick(){return handleAccept(order.id);},children:\"Accept\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger admin-table\",onClick:function onClick(){return handleCancel(order.id);},children:\"Cancel\"})]}),order.active===1&&/*#__PURE__*/_jsx(\"p\",{children:\"Aktyvuotas\"}),order.active===2&&/*#__PURE__*/_jsx(\"p\",{children:\"At\\u0161auktas\"})]})]},order.id);})})]})]})]})]})]})});};export default Admin;","map":{"version":3,"names":["React","useEffect","useState","axios","Table","useNavigate","CancelModal","ResponseNotification","Admin","navigate","sessionToken","sessionStorage","getItem","data","setData","msg","setMsg","showCancelModal","setShowCancelModal","orderId","setOrderId","searchQuery","setSearchQuery","responseData","setResponseData","showNotification","setShowNotification","getData","get","res","handleAccept","post","then","someData","success","handleCancel","value","handleClick","e","target","orders","filter","order","order_nr","includes","tickets","name","lastname","map","active","id"],"sources":["C:/Users/Rokas/Desktop/productionRrloto/frontend/src/Pages/Admin.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from '../api/axios';\r\nimport Table from 'react-bootstrap/Table';\r\nimport { useNavigate } from 'react-router-dom'\r\nimport CancelModal from '../Components/CancelModal';\r\nimport ResponseNotification from '../Components/ResponseNotification';\r\n\r\nconst Admin = () => {\r\n\r\n    const navigate = useNavigate();\r\n    const sessionToken = sessionStorage.getItem(\"loggedIn\");\r\n    const [data, setData] = useState({});\r\n    const [msg, setMsg] = useState(null);\r\n    const [showCancelModal, setShowCancelModal] = useState(false);\r\n    const [orderId, setOrderId] = useState('');\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n\r\n    const [responseData, setResponseData] = useState({});\r\n\r\n    const [showNotification, setShowNotification] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if(!sessionToken)\r\n        {\r\n            navigate('/login');\r\n        }\r\n        const getData = async () => {\r\n            const {data: res} = await axios.get('/admin');\r\n            setData(res);\r\n        }\r\n        getData();\r\n    }, [msg])\r\n    \r\n\r\n    const handleAccept = async (data) => {\r\n        await axios.post(`/admin/confirm/${data}`)\r\n        .then((res) => {\r\n            const someData = {...[res.data.success]};\r\n            setMsg(someData)\r\n        })\r\n    }\r\n\r\n    const handleCancel = (value) => {\r\n        setOrderId(value);\r\n        setShowCancelModal(true);\r\n    }\r\n\r\n    const handleClick = async() => {\r\n        \r\n        await axios.post(`/admin/get-winner`)\r\n        .then((res) => {\r\n            setResponseData(res.data);\r\n            setShowNotification(true);\r\n        })\r\n    }\r\n    \r\n    return(\r\n        <>\r\n            {sessionToken &&\r\n            <>\r\n                <CancelModal showCancelModal={showCancelModal} setShowCancelModal={setShowCancelModal} orderId={orderId} setMsg={setMsg}/>\r\n                <div className='container d-flex admin-panel justify-content-center'>\r\n                    <ResponseNotification data={responseData} showNotification={showNotification} setShowNotification={setShowNotification} />\r\n                    <div className=\"card card-ticket text-center\">\r\n                        <div className=\"card-header\">\r\n                            Admin\r\n                        </div>\r\n                        <div className='card-body'>\r\n                        <div className=\"input-group\">\r\n                            <div className=\"form-outline\">\r\n                                <input \r\n                                    type=\"search\" \r\n                                    className=\"form-control\" \r\n                                    placeholder='search'\r\n                                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"input-group\">\r\n                            <button\r\n                                className=\"btn btn-danger\"\r\n                                onClick={handleClick}\r\n                            >\r\n                                Išrinkti nugalėtoją\r\n                            </button>\r\n                        </div>\r\n                            <Table striped bordered>\r\n                                <thead>\r\n                                    <tr>\r\n                                    <th>ID</th>\r\n                                    <th>Name,Lastname</th>\r\n                                    <th>Action</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {data.orders?.filter((order) => \r\n                                        order.order_nr.includes(searchQuery) ||\r\n                                        order.tickets[0].name.includes(searchQuery) ||\r\n                                        order.tickets[0].lastname.includes(searchQuery) \r\n                                        ).map((order) => (\r\n                                        <tr key={order.id}>\r\n                                            <td>{order.order_nr}</td>\r\n                                            <td>{order.tickets[0].name} {order.tickets[0].lastname}</td>\r\n                                            <td>\r\n                                                \r\n                                                {order.active === 0 && (\r\n                                                    <>\r\n                                                        <button className='btn btn-danger admin-table' onClick={() => handleAccept(order.id)}>Accept</button> \r\n                                                        <button className='btn btn-danger admin-table' onClick={() => handleCancel(order.id)}>Cancel</button>\r\n                                                    </>\r\n                                                )}\r\n                                                {order.active === 1 && (\r\n                                                    <p>Aktyvuotas</p>\r\n                                                )}\r\n                                                {order.active === 2 && (\r\n                                                    <p>Atšauktas</p>\r\n                                                )}\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </Table>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </>\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Admin;"],"mappings":"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"},"metadata":{},"sourceType":"module"}